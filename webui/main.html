<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  {% if is_dev %}
  <link rel="stylesheet/less" type="text/css" href="{{ handler.static_url("css/main.less") }}" />
  <script type="text/javascript" src="{{ handler.static_url("js/less.js") }}"></script>
  {% else %}
  <link rel="stylesheet" type="text/css" href="{{ handler.static_url("css/main.css") }}" />
  {% end %}
  <link rel="stylesheet" type="text/css" href="{{ image_host }}/icons2/icons.css" />
  <script type="text/javascript" src="{{ handler.static_url("js/home.js") }}"></script>
  <script type="text/javascript" src="{{ handler.static_url("js/tlinject.js") }}"></script>
</head>

{% import random %}
{% import itertools %}

<body>
  <div class="container" style="max-width:800px">
    <div class="welcome_spec">
      <img class="chara_image" width="332" height="422" src="{{ image_host }}/chara/{{ 178 }}/0.png" />
      <div class="riinaface" style="background-image:url({{ image_host }}/special/dari{{ random.randint(1, 5) }}.png)"></div>
    </div>
    <input type="text" id="search" placeholder="{{ _("Names") }}" onkeyup="suggest(this, this.value)">
    <div id="suggestions"></div>
  </div>

  {% if has_event %}
  <div id="event_counter_container" class="container" style="max-width:800px;display:none">
    <div class="box Cool" style="margin:0;width:100%">
      <div class="header">
        <span class="item left">Current event</span>
        <span class="item ext"></span>
      </div>
      <div class="content" style="background:#444;text-align:center;">
        <p style="margin:0;">"{% raw tlable(event.name) %}" ends in</p>
        <p id="event_counter" style="font-size:200%;font-weight:bold;margin:6px 0" data-event-end="{{ event_end }}">
          Nothing to see here.
        </p>
        <p style="margin:0;">Better start spending.</p>
      </div>
    </div>
  </div>
  <script> event_counter_init(); </script>
  {% end %}

  <div class="container" style="max-width:800px">
    <p>This is temporary while I sort stuff out...</p>
    <ul>
      <li><a href="/skill_table">Skills table</a></li>
      <li><a href="/lead_skill_table">Lead skills table</a></li>
      <li>Use the search field above to get limited card data...</li>
    </ul>
  </div>

  {% for new_list in history[:8] %}
  <div class="container" style="max-width:800px">
    <div class="box Cool" style="margin-left:0;margin-right:0;width:100%">
      <div class="header">
        <span class="item left">{{ new_list["date"] }}</span>
        <span class="item ext"></span>
        <span class="item right"><a href="/card/{{ ",".join(map(str, itertools.chain(*(x for _, x in new_list["cids"].items())))) }}">Batch</a></span>
      </div>
      <div class="contents" style="background:#333;padding:10px">
        {% for key in ["event", "ssr", "sr", "r", "n"] %}
        {% if new_list["cids"][key] %}
        <div>
          <a href="/card/{{ ",".join(map(str, new_list["cids"][key])) }}">
            <img src="{{ handler.static_url("img/marker_" + key + ".png") }}" />
          </a>
          {% for card in new_list["cids"][key] %}
          <a href="/card/{{ card }}">{% raw icon(card) %}</a>
          {% end %}
        </div>
        {% end %}
        {% end %}
      </div>
    </div>
  </div>
  {% end %}

  {% include footer.html %}
  <script> tlinject_activate() </script>
</body>
</html>